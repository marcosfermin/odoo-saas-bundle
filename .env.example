# ============================================
# Odoo SaaS Platform - Environment Configuration
# ============================================
# Copy this file to .env and update with your values
# DO NOT commit .env to version control!

# ============================================
# PostgreSQL Database Configuration
# ============================================
PG_HOST=postgres  # Use 'postgres' for Docker, 'localhost' for host install
PG_PORT=5432
PG_USER=odoo
PG_PASSWORD=CHANGEME_use_strong_password_here
PG_DATABASE=postgres
PG_SSLMODE=prefer  # Use 'require' for production/remote databases

# ============================================
# Domain Configuration
# ============================================
DOMAIN=odoo.example.com
ADMIN_DOMAIN=admin.odoo.example.com
BASE_DOMAIN=odoo.example.com

# ============================================
# Admin Dashboard Configuration
# ============================================
SECRET_KEY=CHANGEME_generate_random_32_char_string_here
BOOTSTRAP_EMAIL=owner@example.com
BOOTSTRAP_PASSWORD=CHANGEME_initial_owner_password
PORT=9090
FLASK_ENV=production  # or 'development' for debug mode
ADMIN_DB_PATH=/opt/odoo-admin/admin.db

# ============================================
# Odoo Configuration
# ============================================
ODOO_USER=odoo
ODOO_DIR=/opt/odoo/odoo-16.0
ODOO_BIN=/opt/odoo/odoo-16.0/odoo-bin
ODOO_VENV=/opt/odoo/venv
ODOO_LOG=/var/log/odoo/odoo.log
ODOO_SERVICE=odoo
ODOO_MASTER_PASSWORD=CHANGEME_master_admin_password

# Odoo Performance Settings
WORKERS=4  # Number of Odoo workers (0 for single process)
LIMIT_TIME_CPU=120
LIMIT_TIME_REAL=240
LIMIT_REQUEST=8192
LIMIT_MEMORY_HARD=2684354560  # 2.5GB in bytes
LIMIT_MEMORY_SOFT=2147483648  # 2GB in bytes
MAX_CRON_THREADS=2

# ============================================
# Redis Configuration
# ============================================
REDIS_HOST=redis  # Use 'redis' for Docker, 'localhost' for host
REDIS_PORT=6379
REDIS_DB=0
REDIS_URL=redis://redis:6379/0  # Full Redis URL
RQ_QUEUE=odoo_admin_jobs  # RQ queue name

# ============================================
# AWS S3 Configuration
# ============================================
# Leave AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY empty if using IAM roles/IRSA
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
S3_BUCKET=odoo-saas-backups
S3_PREFIX=tenants
S3_SSE=aws:kms  # Server-side encryption type
S3_KMS_KEY_ID=  # KMS key ARN from Terraform output
S3_LIFECYCLE_DAYS=30  # Days to retain backups

# ============================================
# Billing Webhook Configuration
# ============================================
# Generic webhook secret (fallback)
WEBHOOK_SECRET=CHANGEME_random_webhook_secret

# Stripe Configuration
STRIPE_SIGNING_SECRET=whsec_your_stripe_endpoint_secret_here
STRIPE_API_KEY=  # Optional: for Stripe API calls

# Paddle Configuration
PADDLE_PUBLIC_KEY_BASE64=  # Base64 encoded RSA public key from Paddle
PADDLE_VENDOR_ID=  # Optional: your Paddle vendor ID

# ============================================
# Alert Configuration
# ============================================
# Slack Notifications
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#alerts  # Optional: specific channel

# Email Notifications (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-specific-password
SMTP_USE_TLS=true
SMTP_USE_SSL=false
ALERT_EMAIL_FROM=odoo-admin@example.com
ALERT_EMAIL_TO=alerts@example.com,ops-team@example.com  # Comma-separated

# ============================================
# Let's Encrypt / TLS Configuration
# ============================================
LETSENCRYPT_EMAIL=admin@example.com
LETSENCRYPT_STAGING=0  # Set to 1 for testing with staging server
CLOUDFLARE_API_TOKEN=  # For wildcard certificates via DNS-01 challenge

# ============================================
# Monitoring Configuration (Optional)
# ============================================
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090
GRAFANA_ADMIN_PASSWORD=CHANGEME_grafana_admin
METRICS_RETENTION_DAYS=15

# ============================================
# Backup Configuration
# ============================================
BACKUP_SCHEDULE="0 2 * * *"  # Cron format: 2 AM daily
BACKUP_RETENTION_LOCAL=7  # Days to keep local backups
BACKUP_COMPRESSION=true
BACKUP_ENCRYPTION=true
BACKUP_ENCRYPTION_KEY=  # GPG key ID for backup encryption

# ============================================
# Rate Limiting (Optional)
# ============================================
RATE_LIMIT_ENABLED=false
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000
RATE_LIMIT_PER_DAY=10000

# ============================================
# Security Configuration
# ============================================
ALLOWED_HOSTS=odoo.example.com,*.odoo.example.com,admin.odoo.example.com
CSRF_TRUSTED_ORIGINS=https://odoo.example.com,https://*.odoo.example.com
SESSION_COOKIE_SECURE=true  # Set to false for development without HTTPS
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax
SESSION_TIMEOUT_MINUTES=60

# Basic Auth for Admin (Nginx)
ADMIN_BASIC_AUTH_USER=admin
ADMIN_BASIC_AUTH_PASS=CHANGEME_basic_auth_password

# ============================================
# Database Pool Configuration
# ============================================
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ============================================
# Feature Flags (Optional)
# ============================================
FEATURE_MULTI_COMPANY=true
FEATURE_AUTO_BACKUP=true
FEATURE_BILLING_INTEGRATION=true
FEATURE_MODULE_MANAGEMENT=true
FEATURE_QUOTA_ENFORCEMENT=true
FEATURE_AUDIT_LOGGING=true

# ============================================
# Development/Debug Settings
# ============================================
DEBUG=false  # Never set to true in production!
DEBUG_SQL=false
DEBUG_RPC=false
LOG_LEVEL=info  # debug, info, warning, error, critical
LOG_HANDLER=:INFO  # or :DEBUG for verbose logging
WERKZEUG_DEBUG_PIN=off  # Important: keep 'off' in production

# ============================================
# Container/Kubernetes Specific (if applicable)
# ============================================
DOCKER_ENV=1  # Set to 1 when running in Docker
KUBERNETES_NAMESPACE=odoo-saas
CONTAINER_REGISTRY=ghcr.io/yourorg
IMAGE_TAG=latest

# ============================================
# External Service URLs (if different from defaults)
# ============================================
POSTGRES_URL=postgresql://odoo:password@postgres:5432/postgres
ODOO_URL=http://odoo:8069
ADMIN_URL=http://admin:9090
REDIS_SENTINEL_HOSTS=  # For Redis Sentinel setup

# ============================================
# Custom Module Settings
# ============================================
CUSTOM_ADDONS_PATH=/mnt/extra-addons
AUTO_INSTALL_MODULES=base,web,mail
DISABLED_MODULES=

# ============================================
# Tenant Defaults
# ============================================
DEFAULT_TENANT_QUOTA_GB=5
DEFAULT_TENANT_USER_LIMIT=10
DEFAULT_TENANT_LANGUAGE=en_US
DEFAULT_TENANT_TIMEZONE=UTC
DEFAULT_TENANT_CURRENCY=USD

# ============================================
# API Configuration (if API is enabled)
# ============================================
API_ENABLED=false
API_KEY=CHANGEME_generate_api_key
API_RATE_LIMIT=100  # Requests per minute
API_ALLOWED_IPS=  # Comma-separated IP whitelist

# ============================================
# CDN Configuration (Optional)
# ============================================
CDN_ENABLED=false
CDN_URL=https://cdn.example.com
CDN_STATIC_URL=https://static.example.com

# ============================================
# Geolocation (Optional)
# ============================================
GEOIP_DATABASE=/usr/share/GeoIP/GeoLite2-City.mmdb
GEOIP_ENABLED=false

# ============================================
# SSO Configuration (Optional)
# ============================================
SSO_ENABLED=false
OAUTH2_CLIENT_ID=
OAUTH2_CLIENT_SECRET=
OAUTH2_AUTHORIZE_URL=
OAUTH2_TOKEN_URL=
SAML_ENABLED=false
SAML_IDP_URL=
SAML_IDP_CERT=

# ============================================
# Compliance & Audit
# ============================================
GDPR_MODE=false
AUDIT_LOG_RETENTION_DAYS=90
PII_ENCRYPTION_ENABLED=false
PII_ENCRYPTION_KEY=

# ============================================
# END OF CONFIGURATION
# ============================================
# Remember to:
# 1. Change ALL CHANGEME_ values
# 2. Generate strong passwords (use: openssl rand -base64 32)
# 3. Never commit this file with real values to version control
# 4. Back up this configuration securely
# 5. Use different values for staging/production environments